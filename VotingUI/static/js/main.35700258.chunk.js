(this.webpackJsonpchaoshostingui=this.webpackJsonpchaoshostingui||[]).push([[0],{26:function(t,e,n){},27:function(t,e,n){},36:function(t,e,n){"use strict";n.r(e);var o=n(0),r=n.n(o),s=n(9),i=n.n(s),c=(n(26),n(27),n(4)),a=n(8),u=n.n(a),h=n(16),p=n(11),l=n(19),v=n(20),d=n(21),f=n(17),O=n(3),b=n(6),j=function(){function t(e,n){Object(O.a)(this,t),this.http=void 0,this.baseUrl=void 0,this.jsonParseReviver=void 0,this.http=n||window,this.baseUrl=void 0!==e&&null!==e?e:""}return Object(b.a)(t,[{key:"getCurrentVoteState",value:function(){var t=this,e=this.baseUrl+"/Chaos/GetCurrentVoteState";e=e.replace(/[?&]$/,"");return this.http.fetch(e,{method:"GET",headers:{Accept:"text/plain"}}).then((function(e){return t.processGetCurrentVoteState(e)}))}},{key:"processGetCurrentVoteState",value:function(t){var e=this,n=t.status,o={};return t.headers&&t.headers.forEach&&t.headers.forEach((function(t,e){return o[e]=t})),200===n?t.text().then((function(t){var n=""===t?null:JSON.parse(t,e.jsonParseReviver);return w.fromJS(n)})):200!==n&&204!==n?t.text().then((function(t){return x("An unexpected server error occurred.",n,t,o)})):Promise.resolve(null)}},{key:"vote",value:function(t){var e=this,n=this.baseUrl+"/Chaos/Vote?";void 0!==t&&null!==t&&(n+="voteOptionId="+encodeURIComponent(""+t)+"&"),n=n.replace(/[?&]$/,"");return this.http.fetch(n,{method:"POST",headers:{}}).then((function(t){return e.processVote(t)}))}},{key:"processVote",value:function(t){var e=t.status,n={};return t.headers&&t.headers.forEach&&t.headers.forEach((function(t,e){return n[e]=t})),200===e?t.text().then((function(t){})):200!==e&&204!==e?t.text().then((function(t){return x("An unexpected server error occurred.",e,t,n)})):Promise.resolve(null)}},{key:"setNewVoteOptions",value:function(t){var e=this,n=this.baseUrl+"/Chaos/SetNewVoteOptions";n=n.replace(/[?&]$/,"");var o={body:JSON.stringify(t),method:"POST",headers:{"Content-Type":"application/json"}};return this.http.fetch(n,o).then((function(t){return e.processSetNewVoteOptions(t)}))}},{key:"processSetNewVoteOptions",value:function(t){var e=t.status,n={};return t.headers&&t.headers.forEach&&t.headers.forEach((function(t,e){return n[e]=t})),200===e?t.text().then((function(t){})):200!==e&&204!==e?t.text().then((function(t){return x("An unexpected server error occurred.",e,t,n)})):Promise.resolve(null)}},{key:"ws",value:function(){var t=this,e=this.baseUrl+"/ws";e=e.replace(/[?&]$/,"");return this.http.fetch(e,{method:"GET",headers:{}}).then((function(e){return t.processWs(e)}))}},{key:"processWs",value:function(t){var e=t.status,n={};return t.headers&&t.headers.forEach&&t.headers.forEach((function(t,e){return n[e]=t})),200===e?t.text().then((function(t){})):200!==e&&204!==e?t.text().then((function(t){return x("An unexpected server error occurred.",e,t,n)})):Promise.resolve(null)}},{key:"ws2",value:function(){var t=this,e=this.baseUrl+"/host/ws";e=e.replace(/[?&]$/,"");return this.http.fetch(e,{method:"GET",headers:{}}).then((function(e){return t.processWs2(e)}))}},{key:"processWs2",value:function(t){var e=t.status,n={};return t.headers&&t.headers.forEach&&t.headers.forEach((function(t,e){return n[e]=t})),200===e?t.text().then((function(t){})):200!==e&&204!==e?t.text().then((function(t){return x("An unexpected server error occurred.",e,t,n)})):Promise.resolve(null)}}]),t}(),S=function(){function t(e){if(Object(O.a)(this,t),this.optionId=void 0,this.optionDescription=void 0,this.optionVotes=void 0,e)for(var n in e)e.hasOwnProperty(n)&&(this[n]=e[n])}return Object(b.a)(t,[{key:"init",value:function(t){t&&(this.optionId=t.optionId,this.optionDescription=t.optionDescription,this.optionVotes=t.optionVotes)}},{key:"toJSON",value:function(t){return(t="object"===typeof t?t:{}).optionId=this.optionId,t.optionDescription=this.optionDescription,t.optionVotes=this.optionVotes,t}}],[{key:"fromJS",value:function(e){e="object"===typeof e?e:{};var n=new t;return n.init(e),n}}]),t}(),w=function(){function t(e){if(Object(O.a)(this,t),this.previousVotingResult=void 0,this.voteOptionsState=void 0,e)for(var n in e)e.hasOwnProperty(n)&&(this[n]=e[n])}return Object(b.a)(t,[{key:"init",value:function(t){if(t&&(this.previousVotingResult=t.previousVotingResult,Array.isArray(t.voteOptionsState))){this.voteOptionsState=[];var e,n=Object(f.a)(t.voteOptionsState);try{for(n.s();!(e=n.n()).done;){var o=e.value;this.voteOptionsState.push(S.fromJS(o))}}catch(r){n.e(r)}finally{n.f()}}}},{key:"toJSON",value:function(t){if((t="object"===typeof t?t:{}).previousVotingResult=this.previousVotingResult,Array.isArray(this.voteOptionsState)){t.voteOptionsState=[];var e,n=Object(f.a)(this.voteOptionsState);try{for(n.s();!(e=n.n()).done;){var o=e.value;t.voteOptionsState.push(o.toJSON())}}catch(r){n.e(r)}finally{n.f()}}return t}}],[{key:"fromJS",value:function(e){e="object"===typeof e?e:{};var n=new t;return n.init(e),n}}]),t}(),m=function(t){Object(l.a)(n,t);var e=Object(v.a)(n);function n(t,o,r,s,i){var c;return Object(O.a)(this,n),(c=e.call(this)).message=void 0,c.status=void 0,c.response=void 0,c.headers=void 0,c.result=void 0,c.isApiException=!0,c.message=t,c.status=o,c.response=r,c.headers=s,c.result=i,c}return Object(b.a)(n,null,[{key:"isApiException",value:function(t){return!0===t.isApiException}}]),n}(Object(d.a)(Error));function x(t,e,n,o,r){throw null!==r&&void 0!==r?r:new m(t,e,n,o,null)}window.settings=window.settings||{};var y="https://".concat(window.settings.webApiServer),k="wss://".concat(window.settings.webApiServer,"/ws"),g=new j(y),V={voteOptionState:new w({previousVotingResult:"",voteOptionsState:[]})},N=Object(p.b)({name:"voter",initialState:V,reducers:{updateVote:function(t,e){t.voteOptionState=e.payload}}}),E=N.actions.updateVote,A=function(t){return t.voter.voteOptionState},C=N.reducer,J=function t(e){var n=this;Object(O.a)(this,t),this.Socket=void 0,this.HandlerFunc=void 0,this.setupSocket=function(){try{n.Socket=new WebSocket(k)}catch(t){return console.log("An error occurred while setting up the socket, retrying in 5s: ".concat(t)),void setTimeout((function(){return n.setupSocket()}),5e3)}n.Socket.onopen=n.onOpen,n.Socket.onclose=n.onClose},this.onOpen=function(t){console.log("Socket connection established"),n.Socket.onmessage=n.HandlerFunc},this.onClose=function(t){console.log("Web Socket was closed, attempting to reconnect in 5s"),setTimeout((function(){return n.setupSocket()}),5e3)},this.HandlerFunc=e,this.setupSocket()},P=n(1),T=function(t){var e=t.voteOption,n=Object(c.b)();return Object(P.jsx)("div",{className:"col d-grid gap-1",children:Object(P.jsxs)("button",{className:"btn btn-primary",onClick:function(){var t;n((t=e.optionId,function(){var e=Object(h.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.vote(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()))},children:[Object(P.jsx)("span",{children:e.optionDescription}),Object(P.jsx)("br",{}),Object(P.jsxs)("span",{children:["Votes: ",e.optionVotes]})]})},e.optionId)};function I(){var t=Object(c.c)(A),e=Object(c.b)(),n=function(t){var n=w.fromJS(JSON.parse(t.data));e(E(n))};return Object(o.useEffect)((function(){new J(n),e(function(){var t=Object(h.a)(u.a.mark((function t(e){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,g.getCurrentVoteState().then((function(t){return e(E(t))}));case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.log(t.t0);case 8:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(e){return t.apply(this,arguments)}}())}),[]),Object(P.jsxs)("div",{className:"container",children:[Object(P.jsxs)("h1",{className:"text-center",children:["GTA V Torture Tool"," ",Object(P.jsx)("small",{className:"text-muted",children:"for use with 'friends'"})]}),Object(P.jsxs)("p",{className:"lead text-center",children:["Previous vote: ",t.previousVotingResult]}),!t.voteOptionsState&&Object(P.jsx)("div",{className:"spinner-border",role:"status",children:Object(P.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),t.voteOptionsState&&Object(P.jsx)("div",{className:"container",children:Object(P.jsx)("div",{className:"row row-cols-2 gy-2",children:t.voteOptionsState.map((function(t){return Object(P.jsx)(T,{voteOption:t})}))})})]})}var R=function(){return Object(P.jsx)(I,{})},U=Object(p.a)({reducer:{voter:C}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(P.jsx)(r.a.StrictMode,{children:Object(P.jsx)(c.a,{store:U,children:Object(P.jsx)(R,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[36,1,2]]]);
//# sourceMappingURL=main.35700258.chunk.js.map