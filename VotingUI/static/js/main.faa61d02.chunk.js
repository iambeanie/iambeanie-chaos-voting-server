(this.webpackJsonpchaoshostingui=this.webpackJsonpchaoshostingui||[]).push([[0],{47:function(e,t,n){},48:function(e,t,n){},61:function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),a=n(25),i=n.n(a),s=(n(47),n(28)),c=n(22),u=n(5),l=(n(48),n(17)),d=n(6),h=n.n(d),p=n(12),v=n(21),f=n(29),m=n(38),b=n(41),j=n(42),O=n(18),y=n(13),S=n(14),g=function(){function e(t,n){Object(y.a)(this,e),this.http=void 0,this.baseUrl=void 0,this.jsonParseReviver=void 0,this.http=n||window,this.baseUrl=void 0!==t&&null!==t?t:""}return Object(S.a)(e,[{key:"createGame",value:function(e,t){var n=this,r=this.baseUrl+"/Hosting/CreateGame?";if(null===e)throw new Error("The parameter 'roomCode' cannot be null.");if(void 0!==e&&(r+="roomCode="+encodeURIComponent(""+e)+"&"),null===t)throw new Error("The parameter 'roomPassword' cannot be null.");void 0!==t&&(r+="roomPassword="+encodeURIComponent(""+t)+"&"),r=r.replace(/[?&]$/,"");return this.http.fetch(r,{method:"POST",headers:{}}).then((function(e){return n.processCreateGame(e)}))}},{key:"processCreateGame",value:function(e){var t=e.status,n={};return e.headers&&e.headers.forEach&&e.headers.forEach((function(e,t){return n[t]=e})),200===t?e.text().then((function(e){})):200!==t&&204!==t?e.text().then((function(e){return G("An unexpected server error occurred.",t,e,n)})):Promise.resolve(null)}},{key:"updateVoteOptionsForRoom",value:function(e){var t=this,n=this.baseUrl+"/Hosting/UpdateVoteOptionsForRoom";n=n.replace(/[?&]$/,"");var r={body:JSON.stringify(e),method:"POST",headers:{"Content-Type":"application/json"}};return this.http.fetch(n,r).then((function(e){return t.processUpdateVoteOptionsForRoom(e)}))}},{key:"processUpdateVoteOptionsForRoom",value:function(e){var t=e.status,n={};return e.headers&&e.headers.forEach&&e.headers.forEach((function(e,t){return n[t]=e})),200===t?e.text().then((function(e){})):200!==t&&204!==t?e.text().then((function(e){return G("An unexpected server error occurred.",t,e,n)})):Promise.resolve(null)}},{key:"closeGame",value:function(e,t){var n=this,r=this.baseUrl+"/Hosting/CloseGame?";if(null===e)throw new Error("The parameter 'roomPassword' cannot be null.");if(void 0!==e&&(r+="roomPassword="+encodeURIComponent(""+e)+"&"),null===t)throw new Error("The parameter 'roomCode' cannot be null.");void 0!==t&&(r+="roomCode="+encodeURIComponent(""+t)+"&"),r=r.replace(/[?&]$/,"");return this.http.fetch(r,{method:"DELETE",headers:{}}).then((function(e){return n.processCloseGame(e)}))}},{key:"processCloseGame",value:function(e){var t=e.status,n={};return e.headers&&e.headers.forEach&&e.headers.forEach((function(e,t){return n[t]=e})),200===t?e.text().then((function(e){})):200!==t&&204!==t?e.text().then((function(e){return G("An unexpected server error occurred.",t,e,n)})):Promise.resolve(null)}},{key:"hostVoteOptionsTemplate",value:function(){var e=this,t=this.baseUrl+"/Template/HostVoteOptionsTemplate";t=t.replace(/[?&]$/,"");return this.http.fetch(t,{method:"GET",headers:{Accept:"text/plain"}}).then((function(t){return e.processHostVoteOptionsTemplate(t)}))}},{key:"processHostVoteOptionsTemplate",value:function(e){var t=this,n=e.status,r={};return e.headers&&e.headers.forEach&&e.headers.forEach((function(e,t){return r[t]=e})),200===n?e.text().then((function(e){var n=""===e?null:JSON.parse(e,t.jsonParseReviver);return C.fromJS(n)})):200!==n&&204!==n?e.text().then((function(e){return G("An unexpected server error occurred.",n,e,r)})):Promise.resolve(null)}},{key:"vote",value:function(e,t,n){var r=this,o=this.baseUrl+"/Voting/Vote?";if(null===e)throw new Error("The parameter 'roomCode' cannot be null.");if(void 0!==e&&(o+="roomCode="+encodeURIComponent(""+e)+"&"),null===t)throw new Error("The parameter 'round' cannot be null.");if(void 0!==t&&(o+="round="+encodeURIComponent(""+t)+"&"),null===n)throw new Error("The parameter 'optionId' cannot be null.");void 0!==n&&(o+="optionId="+encodeURIComponent(""+n)+"&"),o=o.replace(/[?&]$/,"");return this.http.fetch(o,{method:"POST",headers:{}}).then((function(e){return r.processVote(e)}))}},{key:"processVote",value:function(e){var t=e.status,n={};return e.headers&&e.headers.forEach&&e.headers.forEach((function(e,t){return n[t]=e})),200===t?e.text().then((function(e){})):200!==t&&204!==t?e.text().then((function(e){return G("An unexpected server error occurred.",t,e,n)})):Promise.resolve(null)}},{key:"getCompleteGameState",value:function(e){var t=this,n=this.baseUrl+"/Voting/GetCompleteGameState?";if(null===e)throw new Error("The parameter 'roomCode' cannot be null.");void 0!==e&&(n+="roomCode="+encodeURIComponent(""+e)+"&"),n=n.replace(/[?&]$/,"");return this.http.fetch(n,{method:"GET",headers:{Accept:"text/plain"}}).then((function(e){return t.processGetCompleteGameState(e)}))}},{key:"processGetCompleteGameState",value:function(e){var t=this,n=e.status,r={};return e.headers&&e.headers.forEach&&e.headers.forEach((function(e,t){return r[t]=e})),200===n?e.text().then((function(e){var n=""===e?null:JSON.parse(e,t.jsonParseReviver);return x.fromJS(n)})):200!==n&&204!==n?e.text().then((function(e){return G("An unexpected server error occurred.",n,e,r)})):Promise.resolve(null)}},{key:"getPartialGameState",value:function(e){var t=this,n=this.baseUrl+"/Voting/GetPartialGameState?";if(null===e)throw new Error("The parameter 'roomCode' cannot be null.");void 0!==e&&(n+="roomCode="+encodeURIComponent(""+e)+"&"),n=n.replace(/[?&]$/,"");return this.http.fetch(n,{method:"GET",headers:{Accept:"text/plain"}}).then((function(e){return t.processGetPartialGameState(e)}))}},{key:"processGetPartialGameState",value:function(e){var t=this,n=e.status,r={};return e.headers&&e.headers.forEach&&e.headers.forEach((function(e,t){return r[t]=e})),200===n?e.text().then((function(e){var n=""===e?null:JSON.parse(e,t.jsonParseReviver);return R.fromJS(n)})):200!==n&&204!==n?e.text().then((function(e){return G("An unexpected server error occurred.",n,e,r)})):Promise.resolve(null)}}]),e}(),x=function(){function e(t){if(Object(y.a)(this,e),this.previousResultDescription=void 0,this.currentRound=void 0,this.voteOptionsState=void 0,t)for(var n in t)t.hasOwnProperty(n)&&(this[n]=t[n])}return Object(S.a)(e,[{key:"init",value:function(e){if(e&&(this.previousResultDescription=e.previousResultDescription,this.currentRound=e.currentRound,Array.isArray(e.voteOptionsState))){this.voteOptionsState=[];var t,n=Object(O.a)(e.voteOptionsState);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.voteOptionsState.push(w.fromJS(r))}}catch(o){n.e(o)}finally{n.f()}}}},{key:"toJSON",value:function(e){if((e="object"===typeof e?e:{}).previousResultDescription=this.previousResultDescription,e.currentRound=this.currentRound,Array.isArray(this.voteOptionsState)){e.voteOptionsState=[];var t,n=Object(O.a)(this.voteOptionsState);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.voteOptionsState.push(r.toJSON())}}catch(o){n.e(o)}finally{n.f()}}return e}}],[{key:"fromJS",value:function(t){t="object"===typeof t?t:{};var n=new e;return n.init(t),n}}]),e}(),w=function(){function e(t){if(Object(y.a)(this,e),this.id=void 0,this.count=void 0,this.description=void 0,t)for(var n in t)t.hasOwnProperty(n)&&(this[n]=t[n])}return Object(S.a)(e,[{key:"init",value:function(e){e&&(this.id=e.id,this.count=e.count,this.description=e.description)}},{key:"toJSON",value:function(e){return(e="object"===typeof e?e:{}).id=this.id,e.count=this.count,e.description=this.description,e}}],[{key:"fromJS",value:function(t){t="object"===typeof t?t:{};var n=new e;return n.init(t),n}}]),e}(),k=function(){function e(t){if(Object(y.a)(this,e),this.chaosId=void 0,this.description=void 0,t)for(var n in t)t.hasOwnProperty(n)&&(this[n]=t[n])}return Object(S.a)(e,[{key:"init",value:function(e){e&&(this.chaosId=e.chaosId,this.description=e.description)}},{key:"toJSON",value:function(e){return(e="object"===typeof e?e:{}).chaosId=this.chaosId,e.description=this.description,e}}],[{key:"fromJS",value:function(t){t="object"===typeof t?t:{};var n=new e;return n.init(t),n}}]),e}(),C=function(){function e(t){if(Object(y.a)(this,e),this.roomCode=void 0,this.voteOptions=void 0,t)for(var n in t)t.hasOwnProperty(n)&&(this[n]=t[n])}return Object(S.a)(e,[{key:"init",value:function(e){if(e&&(this.roomCode=e.roomCode,Array.isArray(e.voteOptions))){this.voteOptions=[];var t,n=Object(O.a)(e.voteOptions);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.voteOptions.push(k.fromJS(r))}}catch(o){n.e(o)}finally{n.f()}}}},{key:"toJSON",value:function(e){if((e="object"===typeof e?e:{}).roomCode=this.roomCode,Array.isArray(this.voteOptions)){e.voteOptions=[];var t,n=Object(O.a)(this.voteOptions);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.voteOptions.push(r.toJSON())}}catch(o){n.e(o)}finally{n.f()}}return e}}],[{key:"fromJS",value:function(t){t="object"===typeof t?t:{};var n=new e;return n.init(t),n}}]),e}(),R=function(){function e(t){if(Object(y.a)(this,e),this.partialVoteStates=void 0,t)for(var n in t)t.hasOwnProperty(n)&&(this[n]=t[n])}return Object(S.a)(e,[{key:"init",value:function(e){if(e&&Array.isArray(e.partialVoteStates)){this.partialVoteStates=[];var t,n=Object(O.a)(e.partialVoteStates);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.partialVoteStates.push(V.fromJS(r))}}catch(o){n.e(o)}finally{n.f()}}}},{key:"toJSON",value:function(e){if(e="object"===typeof e?e:{},Array.isArray(this.partialVoteStates)){e.partialVoteStates=[];var t,n=Object(O.a)(this.partialVoteStates);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.partialVoteStates.push(r.toJSON())}}catch(o){n.e(o)}finally{n.f()}}return e}}],[{key:"fromJS",value:function(t){t="object"===typeof t?t:{};var n=new e;return n.init(t),n}}]),e}(),V=function(){function e(t){if(Object(y.a)(this,e),this.id=void 0,this.count=void 0,t)for(var n in t)t.hasOwnProperty(n)&&(this[n]=t[n])}return Object(S.a)(e,[{key:"init",value:function(e){e&&(this.id=e.id,this.count=e.count)}},{key:"toJSON",value:function(e){return(e="object"===typeof e?e:{}).id=this.id,e.count=this.count,e}}],[{key:"fromJS",value:function(t){t="object"===typeof t?t:{};var n=new e;return n.init(t),n}}]),e}(),E=function(e){Object(m.a)(n,e);var t=Object(b.a)(n);function n(e,r,o,a,i){var s;return Object(y.a)(this,n),(s=t.call(this)).message=void 0,s.status=void 0,s.response=void 0,s.headers=void 0,s.result=void 0,s.isApiException=!0,s.message=e,s.status=r,s.response=o,s.headers=a,s.result=i,s}return Object(S.a)(n,null,[{key:"isApiException",value:function(e){return!0===e.isApiException}}]),n}(Object(j.a)(Error));function G(e,t,n,r,o){throw null!==o&&void 0!==o?o:new E(e,t,n,r,null)}window.settings=window.settings||{};var A,P="https://".concat(window.settings.webApiServer),N="https://".concat(window.settings.webApiServer,"/votinghub"),J=("wss://".concat(window.settings.webApiServer,"/Voting/RegisterVoterSocket"),new g(P)),T={gameState:{previousResultDescription:void 0,currentRound:0,gameVotesState:[]}},U=Object(f.b)({name:"room",initialState:T,reducers:{updateCompleteGameState:function(e,t){e.gameState.currentRound=t.payload.currentRound,e.gameState.gameVotesState=t.payload.gameVotesState,e.gameState.previousResultDescription=t.payload.previousResultDescription},updatePartialGameState:function(e,t){var n=e.gameState.gameVotesState.map((function(e){var n,r=t.payload.find((function(t){return t.id===e.id}));return Object(v.a)(Object(v.a)({},e),{},{count:null!==(n=null===r||void 0===r?void 0:r.count)&&void 0!==n?n:e.count})}));e.gameState.gameVotesState=n}}}),I=function(){var e=Object(p.a)(h.a.mark((function e(t,n,r){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,J.vote(t,n,r);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,n,r){return e.apply(this,arguments)}}(),D=U.reducer,$=n(3),F=function(e){var t=e.id,n=e.count,r=e.description,o=e.round,a=e.roomCode,i="btn-primary";switch(t){case 0:i="btn-primary";break;case 1:i="btn-success";break;case 2:i="btn-danger";break;case 3:i="btn-dark"}return Object($.jsx)("div",{className:"col d-grid gap-1",children:Object($.jsxs)("button",{className:"btn btn-lg ".concat(i),onClick:Object(p.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I(a,o,t);case 2:case"end":return e.stop()}}),e)}))),children:[Object($.jsx)("span",{children:r}),Object($.jsx)("br",{}),Object($.jsxs)("span",{children:["Votes: ",n]})]})})},H=n(40);function B(){var e=Object(u.g)().roomCode,t=Object(l.c)((function(e){return e.room.gameState.currentRound}),(function(e,t){return e===t})),n=Object(l.c)((function(e){return e.room.gameState.gameVotesState}),(function(e,t){if(e!==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n].count!==t[n].count)return!1;return!0})),o=Object(l.c)((function(e){return e.room.gameState.previousResultDescription}),(function(e,t){return e===t})),a=Object(l.b)(),i=function(e){null!=e&&a(function(e){return function(){var t=Object(p.a)(h.a.mark((function t(n){var r,o,a,i,s;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s={currentRound:null!==(r=e.currentRound)&&void 0!==r?r:T.gameState.currentRound,previousResultDescription:null!==(o=e.previousResultDescription)&&void 0!==o?o:T.gameState.previousResultDescription,gameVotesState:null!==(a=null===(i=e.voteOptionsState)||void 0===i?void 0:i.map((function(e){var t,n,r;return{count:null!==(t=e.count)&&void 0!==t?t:0,description:null!==(n=e.description)&&void 0!==n?n:"",id:null!==(r=e.id)&&void 0!==r?r:-1}})))&&void 0!==a?a:T.gameState.gameVotesState},t.abrupt("return",n(U.actions.updateCompleteGameState(s)));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(e))},s=function(e){null!=e&&a(function(e){return function(){var t=Object(p.a)(h.a.mark((function t(n){var r,o;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=null===e||void 0===e||null===(r=e.partialVoteStates)||void 0===r?void 0:r.map((function(e){return{count:e.count,id:e.id}}))){t.next=3;break}return t.abrupt("return");case 3:return t.abrupt("return",n(U.actions.updatePartialGameState(o)));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(e))};return Object(r.useEffect)((function(){A.setupConnection(i,s,e),a(function(e){return function(){var t=Object(p.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,J.getCompleteGameState(e).then((function(e){var t,r,o,a;return n(U.actions.updateCompleteGameState({currentRound:null!==(t=e.currentRound)&&void 0!==t?t:T.gameState.currentRound,previousResultDescription:null!==(r=e.previousResultDescription)&&void 0!==r?r:T.gameState.previousResultDescription,gameVotesState:null!==(o=null===(a=e.voteOptionsState)||void 0===a?void 0:a.map((function(e){var t,n,r;return{count:null!==(t=e.count)&&void 0!==t?t:0,description:null!==(n=e.description)&&void 0!==n?n:"",id:null!==(r=e.id)&&void 0!==r?r:-1}})))&&void 0!==o?o:T.gameState.gameVotesState}))})).catch((function(e){console.log("error retrieving initial game state: "+e)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(e))}),[]),Object($.jsxs)($.Fragment,{children:[o&&Object($.jsxs)("p",{className:"lead text-center",children:["Previous vote: ",o]}),(!n||0===n.length)&&Object($.jsx)("p",{className:"lead text-center",children:"Waiting for initial voting options"}),n&&n.length>0&&Object($.jsxs)($.Fragment,{children:[Object($.jsx)("hr",{}),Object($.jsx)("div",{className:"container",children:Object($.jsx)("div",{className:"row row-cols-2 gy-2",children:n.map((function(n){return Object($.jsx)(F,{count:n.count,description:n.description,round:t,id:n.id,roomCode:e},n.id)}))})})]})]})}function M(){var e=Object(u.f)(),t=Object(r.useState)(""),n=Object(s.a)(t,2),o=n[0],a=n[1];return Object($.jsxs)($.Fragment,{children:[Object($.jsx)("br",{}),Object($.jsx)("br",{}),Object($.jsx)("br",{}),Object($.jsx)("br",{}),Object($.jsxs)("div",{className:"input-group input-group-lg",children:[Object($.jsx)("span",{className:"input-group-text",id:"inputGroup-sizing-lg",children:"Enter Room Code"}),Object($.jsx)("input",{type:"text",className:"form-control","aria-label":"Enter Room Code","aria-describedby":"enterRoomCode",value:o,onChange:function(e){a(e.target.value)}}),Object($.jsx)("button",{className:"btn btn-outline-primary",type:"button",onClick:function(){e.push("/room/".concat(o))},children:"Begin Torture"})]})]})}!function(e){var t;function n(e){return r.apply(this,arguments)}function r(){return(r=Object(p.a)(h.a.mark((function e(n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(r=t)||void 0===r?void 0:r.send("registerAsVoter",n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}e.setupConnection=function(e,r,o){(t=(new H.a).withUrl(N).build()).on("newVoteOptions",e),t.on("voteUpdate",r),t.start().then(Object(p.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(o);case 2:case"end":return e.stop()}}),e)})))).catch((function(e){console.log("Error when starting hub connection")}))},e.registerAsVoter=n}(A||(A={}));var W=function(){var e=Object(r.useState)((function(){var e=["mates","friends","cunts","buddies","dudes","bastards","mean people","uncouth individuals","meanies","acquaintances","associates","allies","colleagues","fuck knuckles","organ donors","meat sacks","meat popsicles","stoners"];return e[Math.floor(Math.random()*e.length)]})),t=Object(s.a)(e,1)[0];return Object($.jsxs)(c.a,{children:[Object($.jsx)("nav",{className:"navbar navbar-expand-md navbar-dark bg-dark mb-4",children:Object($.jsx)("div",{className:"container",children:Object($.jsx)(c.b,{to:"/",className:"navbar-brand",children:"To Lobby"})})}),Object($.jsxs)("div",{className:"container",children:[Object($.jsxs)("h1",{className:"text-center",children:["GTA V Torture Tool"," ",Object($.jsxs)("small",{className:"text-muted",children:["for use with '",t,"'"]})]}),Object($.jsxs)(u.c,{children:[Object($.jsx)(u.a,{path:"/room/:roomCode",children:Object($.jsx)(B,{})}),Object($.jsx)(u.a,{path:"/",children:Object($.jsx)(M,{})})]})]})]})},L=Object(f.a)({reducer:{room:D}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object($.jsx)(o.a.StrictMode,{children:Object($.jsx)(l.a,{store:L,children:Object($.jsx)(W,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[61,1,2]]]);
//# sourceMappingURL=main.faa61d02.chunk.js.map